<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Comparative spindle plot of model Bayes factors — SpindleCompare • neotrans</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Comparative spindle plot of model Bayes factors — SpindleCompare"><meta property="og:description" content="SpindleCompare() draws side-by-side spindles comparing the marginal log
likelihoods of paired models. Each spindle shows the distribution of log Bayes
factors between the two models across datasets, with colours indicating which
model is favoured. Areas of non-material difference (where absolute log Bayes
factors are smaller than the propagated standard error) are shown in
semitransparent “ghost” shading."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">neotrans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2025-11-06</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/compare-trees.html">Impact of model choice on tree topologies</a>
    </li>
    <li>
      <a href="../articles/install.html">Install the neotrans package</a>
    </li>
    <li>
      <a href="../articles/matrix-processing.html">Annotate matrices</a>
    </li>
    <li>
      <a href="../articles/model-cost.html">Compuational cost of models</a>
    </li>
    <li>
      <a href="../articles/model-pairs.html">Comparison of model pairs</a>
    </li>
    <li>
      <a href="../articles/parameter-analysis.html">Parameter analysis</a>
    </li>
    <li>
      <a href="../articles/parameter-values.html">Parameter value summary</a>
    </li>
    <li>
      <a href="../articles/predictions.html">Predicting parameters and fit</a>
    </li>
    <li>
      <a href="../articles/prior-posterior.html">Prior-posterior comparison</a>
    </li>
    <li>
      <a href="../articles/stationarity.html">Evaluating stationarity</a>
    </li>
    <li>
      <a href="../articles/wct-comparison.html">Comparison to well-corroborated trees</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ms609/neotrans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Comparative spindle plot of model Bayes factors</h1>
    <small class="dont-index">Source: <a href="https://github.com/ms609/neotrans/blob/main/R/Plotting.R" class="external-link"><code>R/Plotting.R</code></a></small>
    <div class="hidden name"><code>SpindleCompare.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>SpindleCompare()</code> draws side-by-side spindles comparing the marginal log
likelihoods of paired models. Each spindle shows the distribution of log Bayes
factors between the two models across datasets, with colours indicating which
model is favoured. Areas of non-material difference (where absolute log Bayes
factors are smaller than the propagated standard error) are shown in
semitransparent “ghost” shading.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SpindleCompare</span><span class="op">(</span></span>
<span>  <span class="va">modelA</span>,</span>
<span>  <span class="va">modelB</span>,</span>
<span>  <span class="va">marginals</span>,</span>
<span>  <span class="va">stdErr</span>,</span>
<span>  nBin <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-modela">modelA<a class="anchor" aria-label="anchor" href="#arg-modela"></a></dt>
<dd><p>Character vector naming the first set of models to compare.</p></dd>


<dt id="arg-modelb">modelB<a class="anchor" aria-label="anchor" href="#arg-modelb"></a></dt>
<dd><p>Character vector naming the second set of models to compare;
must be the same length as <code>modelA</code>.</p></dd>


<dt id="arg-marginals">marginals<a class="anchor" aria-label="anchor" href="#arg-marginals"></a></dt>
<dd><p>Matrix of marginal log-likelihoods, with models as rows and
datasets as columns.</p></dd>


<dt id="arg-stderr">stdErr<a class="anchor" aria-label="anchor" href="#arg-stderr"></a></dt>
<dd><p>Matrix of standard errors corresponding to <code>marginals</code>.</p></dd>


<dt id="arg-nbin">nBin<a class="anchor" aria-label="anchor" href="#arg-nbin"></a></dt>
<dd><p>Integer giving the number of histogram bins to use for each
spindle (default <code>20</code>).</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>Numeric scaling factor for the maximum spindle width (default <code>1</code>).</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>Character label for the x-axis (default <code>"Model comparison"</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional graphical parameters passed to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>SpindleCompare()</code> returns a matrix whose rows correspond to the entries
in <code>modelA</code> and whose columns count:</p><ul><li><p><code>better</code>:  the number of times <code>modelA</code> outperforms <code>modelB</code>;</p></li>
<li><p><code>worse</code>:  the number of times <code>modelA</code> is outperformed by <code>modelB</code>;</p></li>
<li><p><code>n</code>:  the number of datasets compared, after removing <code>NA</code>s.
The function is called for its side-effect of producing a comparative spindle
plot.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Each spindle is constructed from the histogram of Bayes factors
\(bf = marginals[modelA[i], ] - marginals[modelB[i], ]\).
Bars where \(|bf| &lt; .DiffErr(stdErr[modelA[i], ], stdErr[modelB[i], ])\)
are shown in semitransparent colour; other bars are fully opaque. Positive
values (favouring <code>modelA</code>) are coloured by <code>ModelCol(modelA)</code>, and negative
values (favouring <code>modelB</code>) by <code>ModelCol(modelB)</code>.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martin R. Smith.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

