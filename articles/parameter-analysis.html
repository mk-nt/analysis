<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parameter analysis â€¢ neotrans</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Parameter analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">neotrans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2025-11-06</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/compare-trees.html">Impact of model choice on tree topologies</a>
    </li>
    <li>
      <a href="../articles/install.html">Install the neotrans package</a>
    </li>
    <li>
      <a href="../articles/matrix-processing.html">Annotate matrices</a>
    </li>
    <li>
      <a href="../articles/model-cost.html">Compuational cost of models</a>
    </li>
    <li>
      <a href="../articles/model-pairs.html">Comparison of model pairs</a>
    </li>
    <li>
      <a href="../articles/parameter-analysis.html">Parameter analysis</a>
    </li>
    <li>
      <a href="../articles/parameter-values.html">Parameter value summary</a>
    </li>
    <li>
      <a href="../articles/predictions.html">Predicting parameters and fit</a>
    </li>
    <li>
      <a href="../articles/prior-posterior.html">Prior-posterior comparison</a>
    </li>
    <li>
      <a href="../articles/stationarity.html">Evaluating stationarity</a>
    </li>
    <li>
      <a href="../articles/wct-comparison.html">Comparison to well-corroborated trees</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ms609/neotrans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Parameter analysis</h1>
                        <h4 data-toc-skip class="author">Martin R. Smith
<a href="mailto:martin.smith@durham.ac.uk" class="email">martin.smith@durham.ac.uk</a>
</h4>
            
            <h4 data-toc-skip class="date">2025-11-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ms609/neotrans/blob/main/vignettes/parameter-analysis.Rmd" class="external-link"><code>vignettes/parameter-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>parameter-analysis.Rmd</code></div>

    </div>

    
    
<p>Analysis of parameter values and properties.</p>
<div class="section level2">
<h2 id="prepare-analysis-environment">Prepare analysis environment<a class="anchor" aria-label="anchor" href="#prepare-analysis-environment"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">"randomForest"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/neotrans/" class="external-link">"neotrans"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">.meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Metadata.html">Metadata</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">.config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Config.html">Config</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">epsBF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co"># "Strong" support, per Jeffries 1939</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="models-with-a-free-t-parameter">Models with a free <em>t</em> parameter<a class="anchor" aria-label="anchor" href="#models-with-a-free-t-parameter"></a>
</h2>
<div class="section level3">
<h3 id="review-accuracy-of-marginal-likelihood-estimates">Review accuracy of marginal likelihood estimates<a class="anchor" aria-label="anchor" href="#review-accuracy-of-marginal-likelihood-estimates"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelsT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by_ki"</span>, <span class="st">"by_n_ki"</span>, <span class="st">"by_t_ki"</span>, <span class="st">"by_nt_ki"</span>, <span class="st">"rm_by_t_ki"</span><span class="op">)</span></span>
<span><span class="va">marginals</span> <span class="op">&lt;-</span> <span class="fu">GetMarginals</span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsT</span><span class="op">)</span></span>
<span><span class="va">stdErr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">marginals</span>, <span class="st">"stdErr"</span><span class="op">)</span></span>
<span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MarginalDiffs.html">MarginalDiffs</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stdErr</span>, <span class="va">mds</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Standard error of estimate"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Difference, stepping stone vs path sampling estimates"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsT</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="../reference/ModelLabel.html">ModelLabel</a></span><span class="op">(</span><span class="va">modelsT</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsT</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-1-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="when-is-a-partitioned-model-preferred">When is a partitioned model preferred?<a class="anchor" aria-label="anchor" href="#when-is-a-partitioned-model-preferred"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">part</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EvaluatePartitioning.html">EvaluatePartitioning</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## by_t is &gt;eps better than unpartitioned in 15 / 64 projects.</span></span></code></pre>
<pre><code><span><span class="co">## by_t is &gt;eps better than rm_by_t in 13 / 15 of these.</span></span></code></pre>
<pre><code><span><span class="co">## rm_by_t is best model by &gt;eps in 3 / 64</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tSupport</span> <span class="op">&lt;-</span> <span class="va">part</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">part</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span></span>
<span><span class="va">tErr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tFitsBest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">tSupport</span>, <span class="va">tErr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tFitsBest</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 15</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">tSupport</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="va">epsBF</span>, <span class="fl">0</span>, <span class="va">epsBF</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="op">]</span>, <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="op">]</span>,</span>
<span>     pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tFitsBest</span> <span class="op">|</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="op">-</span><span class="va">tSupport</span>, <span class="va">tErr</span><span class="op">)</span>, <span class="fl">16</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="va">tCol</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Transformational characters"</span>, ylab <span class="op">=</span> <span class="st">"Neomorphic characters"</span>,</span>
<span>     log <span class="op">=</span> <span class="st">"xy"</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, bty <span class="op">=</span> <span class="st">"n"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">~</span> <span class="st">"parameter:"</span><span class="op">)</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Free preferred"</span>,</span>
<span>                  <span class="st">"Fixed preferred"</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"BF &gt; "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">epsBF</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"BF &lt; "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">epsBF</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       pt.cex <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>               <span class="st">"grey10"</span>, <span class="st">"grey10"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/t-bf-support-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare estimated values of t</span></span>
<span><span class="va">bestTModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span>,</span>
<span>                     <span class="st">"by_t_ki"</span>, <span class="st">"by_nt_ki"</span><span class="op">)</span></span>
<span><span class="va">tProjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bestTModel</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bestTModel</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Estimated value of t using the best available stationary model</span></span>
<span><span class="va">stationaryT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tProjects</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">exRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestTModel</span><span class="op">[[</span><span class="va">pID</span><span class="op">]</span><span class="op">]</span>, checkRemote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">exRes</span><span class="op">[[</span><span class="st">"convergence"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ess"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">.config</span><span class="op">$</span><span class="va">essThreshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Extending run for "</span>, <span class="va">pID</span>, <span class="st">"_"</span>, <span class="va">bestTModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestTModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span>, ml <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">exRes</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="st">"rate_neo"</span><span class="op">]</span></span>
<span>  <span class="co"># partition_rate := [ rate_neo / (1 + rate_neo), (1 / (1 + rate_neo)) ]</span></span>
<span>  <span class="co"># MS defines t = rate_t / rate_n</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Need results for "</span>, <span class="va">pID</span>, <span class="st">"_"</span>, <span class="va">bestTModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/RevBayes.html">RevBayes</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestTModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestTModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span>, ml <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.5%"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"97.5%"</span>, <span class="st">"mad"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># Convert from rate_neo to rate_trans</span></span>
<span>    <span class="fl">1</span> <span class="op">/</span> <span class="va">res</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log(stationaryT["50%", ])</span></span>
<span><span class="co">## W = 0.96834, p-value = 0.09911</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log(stationaryT["50%", ])</span></span>
<span><span class="co">## t = 7.2276, df = 63, p-value = 8.008e-10</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.6826026 1.2043076</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">## 0.9434551</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.47</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"mad"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.39</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"mad"</span>, <span class="op">]</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7.22</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.57</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.044</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Because of the conversion, the 2.5%ile is "high" and the 97.5%ile is "low"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span></span>
<span>  <span class="st">"Median: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="st">" (= 1/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="st">"), mad "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="st">"; LogMean: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="st">", sd "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Median: 2.47 (= 1/0.405), mad 1.7; LogMean: 2.57, sd 2.84</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tNotOne</span> <span class="op">&lt;-</span> <span class="va">stationaryT</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">stationaryT</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Different from 1: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tNotOne</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="st">" / "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tNotOne</span><span class="op">)</span><span class="op">)</span>, <span class="st">": "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">" &gt; 1; "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">" &lt; 1"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Different from 1: 36 / 64: 34 &gt; 1; 2 &lt; 1</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ntBest</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bestTModel</span> <span class="op">==</span> <span class="st">"by_nt_ki"</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bestTModel</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">tModelBF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tProjects</span><span class="op">)</span><span class="op">)</span>, <span class="va">tProjects</span><span class="op">)</span></span>
<span><span class="va">tModelBF</span><span class="op">[</span><span class="va">ntBest</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="va">tProjects</span><span class="op">[</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> </span>
<span>  <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="va">tProjects</span><span class="op">[</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">tModelBF</span><span class="op">[</span><span class="op">!</span><span class="va">ntBest</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="va">tProjects</span><span class="op">[</span><span class="op">!</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> </span>
<span>  <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="va">tProjects</span><span class="op">[</span><span class="op">!</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">tColBin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tModelBF</span> <span class="op">&lt;</span> <span class="fl">0</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tModelBF</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="op">-</span><span class="va">epsBF</span>, <span class="op">-</span><span class="va">tErr</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tModelBF</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">epsBF</span>, <span class="va">tErr</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">[</span><span class="va">tColBin</span><span class="op">]</span></span>
<span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span>, <span class="va">tModelBF</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Inferred"</span> <span class="op">~</span> <span class="fu">italic</span><span class="op">(</span><span class="st">"t"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># under best stationary model</span></span>
<span>       ylab <span class="op">=</span> <span class="st">"log(Model BF)"</span>, xpd <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>       frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, pch <span class="op">=</span> <span class="fl">4</span>, log <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span>  <span class="va">confidenceCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span></span>
<span>  <span class="va">iqr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"75%"</span>, <span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"25%"</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span>, <span class="va">tModelBF</span>, <span class="va">stationaryT</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span>, xpd <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>           col <span class="op">=</span> <span class="va">confidenceCol</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">iqr</span>, breaks <span class="op">=</span> <span class="fl">256</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span>, <span class="va">tModelBF</span>, col <span class="op">=</span> <span class="va">tCol</span>,</span>
<span>         pch <span class="op">=</span> <span class="fl">4</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="predict-which-projects-will-favour-a-free-t">Predict which projects will favour a free <em>t</em><a class="anchor" aria-label="anchor" href="#predict-which-projects-will-favour-a-free-t"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Can we predict which projects will benefit from a free t parameter?</span></span>
<span><span class="va">tProj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tSupport</span><span class="op">)</span></span>
<span><span class="va">tMeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="va">tSupport</span>,</span>
<span>  nChar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span>, <span class="va">tProj</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  nTrans <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="va">tProj</span><span class="op">]</span>,</span>
<span>  nNeo <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="va">tProj</span><span class="op">]</span>,</span>
<span>  logNTRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="va">tProj</span><span class="op">]</span> <span class="op">/</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="va">tProj</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  charPerTax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span>, <span class="va">tProj</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="va">tProj</span><span class="op">]</span>,</span>
<span>  taxon <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="va">tProj</span><span class="op">]</span>,</span>
<span>  rank <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">rank</span><span class="op">[</span><span class="va">tProj</span><span class="op">]</span>,</span>
<span>  nTaxa <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="va">tProj</span><span class="op">]</span>,</span>
<span>  tValue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">stationaryT</span><span class="op">[</span>, <span class="va">tProj</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tPredictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nChar"</span>, <span class="st">"logNTRatio"</span>, <span class="st">"charPerTax"</span>, <span class="st">"taxon"</span>, <span class="st">"rank"</span>, <span class="st">"nTaxa"</span>,</span>
<span>                 <span class="st">"tValue.50."</span><span class="op">)</span></span>
<span><span class="va">vsurfBF</span> <span class="op">&lt;-</span> <span class="fu">VSURF</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/VSURF/man/VSURF.html" class="external-link">VSURF</a></span><span class="op">(</span><span class="va">tMeta</span><span class="op">[</span>, <span class="va">tPredictors</span><span class="op">]</span>, <span class="va">tSupport</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">predBF</span> <span class="op">&lt;-</span> <span class="va">tPredictors</span><span class="op">[</span><span class="va">vsurfBF</span><span class="op">[[</span><span class="st">"varselect.pred"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">predBF</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">predBF</span> <span class="op">&lt;-</span> <span class="va">tPredictors</span><span class="op">[</span><span class="va">vsurfBF</span><span class="op">[[</span><span class="st">"varselect.interp"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">predBF</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tValue.50., charPerTax, logNTRatio</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rfBF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">tMeta</span><span class="op">[</span>, <span class="va">predBF</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="va">tSupport</span>,</span>
<span>                     ntree <span class="op">=</span> <span class="fl">10000</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">rfBF</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             %IncMSE IncNodePurity</span></span>
<span><span class="co">## tValue.50. 71.01203      424.4242</span></span>
<span><span class="co">## charPerTax 38.02196      371.7210</span></span>
<span><span class="co">## logNTRatio 56.94737      367.3868</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html" class="external-link">varImpPlot</a></span><span class="op">(</span><span class="va">rfBF</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/rf-t-1.png" width="672"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">predBF</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nPred</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">predictor</span> <span class="kw">in</span> <span class="va">predBF</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/partialPlot.html" class="external-link">partialPlot</a></span><span class="op">(</span><span class="va">rfBF</span>, <span class="va">tMeta</span><span class="op">[</span>, <span class="va">tPredictors</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span>,</span>
<span>              rug <span class="op">=</span> <span class="cn">TRUE</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">""</span>,</span>
<span>              xlab <span class="op">=</span> <span class="fu"><a href="../reference/Decrypt.html">Decrypt</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span>,</span>
<span>              ylab <span class="op">=</span> <span class="st">"Impact on predicted log(BF)"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/rf-t-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="does-metadata-predict-the-value-of-t">Does metadata predict the value of <em>t</em>?<a class="anchor" aria-label="anchor" href="#does-metadata-predict-the-value-of-t"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Can we predict the value of t from the metadata?</span></span>
<span><span class="va">metaT</span> <span class="op">&lt;-</span> <span class="va">tMeta</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tMeta</span><span class="op">[</span>, <span class="st">"tValue.50."</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">t50</span> <span class="op">&lt;-</span> <span class="va">metaT</span><span class="op">[</span>, <span class="st">"tValue.50."</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">t50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">## -2.3752  0.4841  0.9036  0.9435  1.5183  3.6671</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">t50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.044276</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">t50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  t50</span></span>
<span><span class="co">## W = 0.96834, p-value = 0.09911</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">t50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  t50</span></span>
<span><span class="co">## t = 7.2276, df = 63, p-value = 8.008e-10</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.6826026 1.2043076</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">## 0.9434551</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vsurfT</span> <span class="op">&lt;-</span> <span class="fu">VSURF</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/VSURF/man/VSURF.html" class="external-link">VSURF</a></span><span class="op">(</span><span class="va">metaT</span><span class="op">[</span>, <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">tPredictors</span>, <span class="st">"tValue.50."</span><span class="op">)</span><span class="op">]</span>, <span class="va">t50</span>,</span>
<span>                       verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">predT</span> <span class="op">&lt;-</span> <span class="va">tPredictors</span><span class="op">[</span><span class="va">vsurfT</span><span class="op">[[</span><span class="st">"varselect.pred"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">predT</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## logNTRatio, nTaxa</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Surprisingly, yes.  Why might this be?</span></span>
<span><span class="va">rfT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">metaT</span><span class="op">[</span>, <span class="va">predT</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="va">t50</span>, ntree <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                    importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html" class="external-link">varImpPlot</a></span><span class="op">(</span><span class="va">rfT</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/partialPlot.html" class="external-link">partialPlot</a></span><span class="op">(</span><span class="va">rfT</span>, <span class="va">metaT</span>, <span class="va">logNTRatio</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t50</span> <span class="op">~</span> <span class="va">metaT</span><span class="op">$</span><span class="va">logNTRatio</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-4-2.png" width="576"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/partialPlot.html" class="external-link">partialPlot</a></span><span class="op">(</span><span class="va">rfT</span>, <span class="va">metaT</span>, <span class="va">nTaxa</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t50</span> <span class="op">~</span> <span class="va">metaT</span><span class="op">$</span><span class="va">nTaxa</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-4-3.png" width="576"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">part</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">part</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span> <span class="op">~</span> <span class="va">.meta</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span><span class="op">]</span>, las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, ylab <span class="op">=</span> <span class="st">"by_t &gt; by"</span>, notch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>, <span class="fl">16</span><span class="op">)</span>, eps <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../reference/TaxonCol.html">TaxonCol</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in (function (z, notch = FALSE, width = NULL, varwidth = FALSE, : some</span></span>
<span><span class="co">## notches went outside hinges ('box'): maybe set notch=FALSE</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tPref</span> <span class="op">&lt;-</span> <span class="va">part</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">part</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tPref</span><span class="op">)</span><span class="op">]</span>, <span class="va">tPref</span>,</span>
<span>     log <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>     frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Number of taxa"</span>, ylab <span class="op">=</span> <span class="st">"by_t &gt; by"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tPref</span><span class="op">)</span><span class="op">]</span>, <span class="va">part</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">part</span><span class="op">[</span><span class="st">"rm_by_t_ki"</span>, <span class="op">]</span>,</span>
<span>       col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-4-4.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="free-n-parameter-gain-to-loss-ratio">Free <em>n</em> parameter (gain to loss ratio)<a class="anchor" aria-label="anchor" href="#free-n-parameter-gain-to-loss-ratio"></a>
</h2>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelsN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by_ki"</span>,</span>
<span>             <span class="st">"by_n_ki"</span>, <span class="st">"by_nn_ki"</span>, <span class="st">"by_t_ki"</span>, <span class="st">"by_nt_ki"</span>,</span>
<span>             <span class="st">"ns_ki"</span>, <span class="st">"ns_n_ki"</span>, <span class="st">"ns_nt_ki"</span>,</span>
<span>             <span class="st">"rm_by_n_ki"</span>, <span class="st">"rm_by_nt_ki"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">marginals</span> <span class="op">&lt;-</span> <span class="fu">GetMarginals</span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsN</span><span class="op">)</span></span>
<span><span class="va">stdErr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">marginals</span>, <span class="st">"stdErr"</span><span class="op">)</span></span>
<span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MarginalDiffs.html">MarginalDiffs</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsN</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/initialize-n-1.png" width="672"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stdErr</span>, <span class="va">mds</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Standard error of estimate"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Difference, stepping stone vs path sampling estimates"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsN</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="../reference/ModelLabel.html">ModelLabel</a></span><span class="op">(</span><span class="va">modelsN</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsN</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/initialize-n-2.png" width="672"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number in which StN outperforms StMk</span></span>
<span><span class="va">.ErrCompare</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mod1</span>, <span class="va">mod2</span>, <span class="va">eps</span> <span class="op">=</span> <span class="va">epsBF</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="va">mod1</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="va">mod2</span>, <span class="op">]</span>,</span>
<span>                <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="va">mod1</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="va">mod2</span>, <span class="op">]</span><span class="op">)</span>, <span class="va">eps</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">stnWins</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_n_ki"</span>, <span class="st">"by_ki"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"outperforms StMk in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stnWins</span><span class="op">)</span>, <span class="st">" of "</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## outperforms StMk in 24 of 64</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ... and number in which StN outperforms StN-shuffled</span></span>
<span><span class="va">stnBeatsRandom</span> <span class="op">&lt;-</span> <span class="va">stnWins</span> <span class="op">&amp;</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_n_ki"</span>, <span class="st">"rm_by_n_ki"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stnBeatsRandom</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">" of these "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stnWins</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">stnBeatsRandom</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 17 of these 24</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span></span>
<span>  <span class="st">"StMk was preferred in "</span>,</span>
<span>  <span class="co"># Number in which StMk outperforms StN</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_n_ki"</span>, <span class="st">"by_ki"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">" of "</span>, <span class="co"># Number of datasets for which data are available</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">" datasets."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## StMk was preferred in 24 of 64 datasets.</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stNt</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_nt_ki"</span>, <span class="st">"by_t_ki"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span></span>
<span>  <span class="st">"StNT outperforms StT in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stNt</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">stNt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">" datasets, and underperforms in "</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_t_ki"</span>, <span class="st">"by_nt_ki"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## StNT outperforms StT in 27/64 datasets, and underperforms in 3</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stnWithT</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_nt_ki"</span>, <span class="st">"by_t_ki"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_t_ki"</span>, <span class="st">"by_ki"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"StNT beats StT in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stnWithT</span><span class="op">)</span>, <span class="st">" of "</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_t_ki"</span>, <span class="st">"by_ki"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="st">" cases where free t param is supported"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## StNT beats StT in 8 of 15 cases where free t param is supported</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">EvaluateMk2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">marginals</span>, <span class="va">stdErr</span>, <span class="va">epsBF</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">suffix</span> <span class="op">=</span> <span class="st">"_ki"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by"</span>, <span class="st">"by_n"</span>, <span class="st">"by_t"</span>, <span class="st">"by_nt"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">suffix</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"base"</span>, <span class="st">"n"</span>, <span class="st">"t"</span>, <span class="st">"nt"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">mk2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelBF.html">ModelBF</a></span><span class="op">(</span><span class="va">marginals</span>, <span class="va">models</span><span class="op">)</span></span>
<span>  <span class="va">baseMarginal</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="va">models</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"base"</span>, <span class="st">"t"</span><span class="op">)</span><span class="op">]</span>, <span class="op">]</span></span>
<span>  <span class="va">colSelect</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">baseMarginal</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">baseRow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">baseMarginal</span><span class="op">[</span>, <span class="va">colSelect</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span>  <span class="va">baseModel</span> <span class="op">&lt;-</span> <span class="va">models</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"base"</span>, <span class="st">"t"</span><span class="op">)</span><span class="op">[</span><span class="va">baseRow</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">nModel</span> <span class="op">&lt;-</span> <span class="va">models</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"nt"</span><span class="op">)</span><span class="op">[</span><span class="va">baseRow</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">baseMarginal</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">baseModel</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">baseRow</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">nMarginal</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">nModel</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">baseRow</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">baseErr</span> <span class="op">&lt;-</span> <span class="va">stdErr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">baseModel</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">baseRow</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">nErr</span> <span class="op">&lt;-</span> <span class="va">stdErr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">nModel</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">baseRow</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">nImprovement</span> <span class="op">&lt;-</span> <span class="va">nMarginal</span> <span class="op">-</span> <span class="va">baseMarginal</span></span>
<span>  </span>
<span>  <span class="va">good</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">nImprovement</span>, <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">baseErr</span>, <span class="va">nErr</span><span class="op">)</span>, <span class="va">epsBF</span><span class="op">)</span></span>
<span>  <span class="va">bad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="op">-</span><span class="va">nImprovement</span>, <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">baseErr</span>, <span class="va">nErr</span><span class="op">)</span>, <span class="va">epsBF</span><span class="op">)</span></span>
<span>  <span class="va">ugly</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">good</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">bad</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Mk2 improves in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">good</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          <span class="st">", indifferent in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ugly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          <span class="st">"; deleterious in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">bad</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">" / "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">nImprovement</span><span class="op">)</span><span class="op">)</span>, <span class="st">" projects."</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span></span>
<span>    <span class="va">nImprovement</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">baseRow</span><span class="op">)</span>,</span>
<span>    nBetter <span class="op">=</span> <span class="va">good</span>,</span>
<span>    nWorse <span class="op">=</span> <span class="va">bad</span>,</span>
<span>    err <span class="op">=</span> <span class="va">nErr</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mk2</span> <span class="op">&lt;-</span> <span class="fu">EvaluateMk2</span><span class="op">(</span><span class="va">marginals</span>, <span class="va">stdErr</span>, eps <span class="op">=</span> <span class="va">epsBF</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mk2 improves in 25, indifferent in 33; deleterious in 6 / 64 projects.</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">betterNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">mk2</span>, <span class="st">"nBetter"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">rm</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by_n_ki"</span>, <span class="st">"rm_by_n_ki"</span><span class="op">)</span>, <span class="va">betterNames</span><span class="op">]</span></span>
<span><span class="va">rm</span> <span class="op">&lt;-</span> <span class="va">rm</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rm</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rm</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="va">rm</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span>, <span class="st">" ("</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">rm</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">rm</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>,</span>
<span>                          <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rm</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                   <span class="va">stdErr</span><span class="op">[</span><span class="st">"rm_by_n_ki"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rm</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="st">" by eps) / "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">rm</span><span class="op">)</span>, <span class="st">" projects prefer by_n_ki to rm_by_n_ki"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 22 (2 by eps) / 25 projects prefer by_n_ki to rm_by_n_ki</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Equivalent numbers under non-stationary model</span></span>
<span><span class="co"># Number in which NstN outperforms NstMk</span></span>
<span><span class="va">nstnWins</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"ns_n_ki"</span>, <span class="st">"ns_ki"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">nstnWins</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 28</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">nstnWins</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number in which StMk outperforms StN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"ns_ki"</span>, <span class="st">"ns_ki"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of datasets for which data are available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"ns_n_ki"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"ns_ki"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary: very similar, with slightly more preferring free n</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mk2Col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">mk2</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="va">epsBF</span>, <span class="fl">0</span>, <span class="va">epsBF</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span><span class="op">]</span> <span class="op">/</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span><span class="op">]</span>, <span class="va">mk2</span>,</span>
<span>     log <span class="op">=</span> <span class="st">"x"</span>, col <span class="op">=</span> <span class="va">mk2Col</span>, pch <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Neo:Trans"</span>, ylab <span class="op">=</span> <span class="st">"Mk2 BF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="va">mk2</span>,</span>
<span>     log <span class="op">=</span> <span class="st">"x"</span>, col <span class="op">=</span> <span class="va">mk2Col</span>, pch <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Number of characters"</span>, ylab <span class="op">=</span> <span class="st">"Mk2 BF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span><span class="op">]</span>, <span class="va">mk2</span>, </span>
<span>     log <span class="op">=</span> <span class="st">"x"</span>, col <span class="op">=</span> <span class="va">mk2Col</span>, pch <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Number of taxa"</span>, ylab <span class="op">=</span> <span class="st">"Mk2 BF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-6-3.png" width="672"></p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">EvaluateNonStat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">marginals</span>, <span class="va">se</span>, <span class="va">epsBF</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">suffix</span> <span class="op">=</span> <span class="st">"_ki"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by"</span>, <span class="st">"by_n"</span>, <span class="st">"ns"</span>, <span class="st">"ns_n"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">suffix</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"sn"</span>, <span class="st">"ns"</span>, <span class="st">"nsn"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelBF.html">ModelBF</a></span><span class="op">(</span><span class="va">marginals</span>, <span class="va">models</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ns_helps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"ns"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                            <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"ns"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>, <span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>                            <span class="va">epsBF</span><span class="op">)</span></span>
<span>  <span class="va">ns_hinders</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"ns"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                              <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"ns"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>, <span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>                              <span class="va">epsBF</span><span class="op">)</span></span>
<span>  <span class="va">mk2_helps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"sn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                             <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"sn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>, <span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>                             <span class="va">epsBF</span><span class="op">)</span></span>
<span>  <span class="va">mk2_hinders</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"sn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                               <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"s"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>, <span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"sn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>                               <span class="va">epsBF</span><span class="op">)</span></span>
<span>  <span class="va">both_beat_ns</span> <span class="op">&lt;-</span> <span class="va">ns_helps</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span></span>
<span>    <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"nsn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"ns"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>    <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"nsn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>, <span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"ns"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="va">epsBF</span><span class="op">)</span></span>
<span>  <span class="va">both_beat_mk2</span> <span class="op">&lt;-</span> <span class="va">mk2_helps</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span></span>
<span>    <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"nsn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">ml</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"sn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>    <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"nsn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span>, <span class="va">se</span><span class="op">[</span><span class="va">models</span><span class="op">[[</span><span class="st">"sn"</span><span class="op">]</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="va">epsBF</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Non-stat improves in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ns_helps</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ml</span><span class="op">)</span>,</span>
<span>          <span class="st">" (worse in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ns_hinders</span><span class="op">)</span>,</span>
<span>          <span class="st">"), of which Mk2 further improves "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">both_beat_ns</span><span class="op">)</span>, <span class="st">"."</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Mk2 improves in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mk2_helps</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ml</span><span class="op">)</span>, </span>
<span>          <span class="st">" (worse in "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mk2_hinders</span><span class="op">)</span>,</span>
<span>          <span class="st">"), of which Non-stat further improves "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">both_beat_mk2</span><span class="op">)</span>, <span class="st">"."</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">ml</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">EvaluateNonStat</span><span class="op">(</span><span class="va">marginals</span>, <span class="va">stdErr</span>, eps <span class="op">=</span> <span class="va">epsBF</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Non-stat improves in 16/64 (worse in 3), of which Mk2 further improves 10.</span></span></code></pre>
<pre><code><span><span class="co">## Mk2 improves in 24/64 (worse in 4), of which Non-stat further improves 6.</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"ns_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span></span>
<span><span class="va">ns_n</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"ns_n_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span></span>
<span><span class="va">by_n</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ns</span> <span class="op">~</span> <span class="va">by_n</span>, asp <span class="op">=</span> <span class="fl">1</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span>diag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ns_n</span> <span class="op">~</span> <span class="va">by_n</span>, asp <span class="op">=</span> <span class="fl">1</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Mkn - Mk"</span>, ylab <span class="op">=</span> <span class="st">"ns_n - Mk"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span>vert <span class="op">=</span> <span class="cn">TRUE</span>, diag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-7-2.png" width="672"></p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"ns_n_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"ns_ki"</span>, <span class="op">]</span>,</span>
<span>     <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"+n, non-stat"</span>, ylab <span class="op">=</span> <span class="st">"+n, stationary"</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span>vert <span class="op">=</span> <span class="cn">TRUE</span>, diag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-7-3.png" width="672"></p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare estimated values of n</span></span>
<span><span class="va">bestNModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span>,</span>
<span>                     <span class="st">"by_n_ki"</span>, <span class="st">"by_nt_ki"</span><span class="op">)</span></span>
<span><span class="va">nProjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bestNModel</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bestNModel</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Estimated value of n using the best available stationary model</span></span>
<span><span class="co"># Strictly, this vector stores 1 / n, i.e. rate_loss not rate_gain</span></span>
<span><span class="va">stationaryN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nProjects</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestNModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span>,</span>
<span>                  checkRemote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="st">"rate_loss"</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Need results for "</span>, <span class="va">pID</span>, <span class="st">"_"</span>, <span class="va">bestNModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/RevBayes.html">RevBayes</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestNModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestNModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span>, ml <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">res</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.5%"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"97.5%"</span>, <span class="st">"mad"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nNotOne</span> <span class="op">&lt;-</span> <span class="va">stationaryN</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">stationaryN</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="fl">1</span></span>
<span><span class="co"># convert 1 / rate_loss yields rate_gain</span></span>
<span><span class="va">n50</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">stationaryN</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">## 0.06625 0.30510 0.49713 0.46422 0.73958 3.85226</span></span></code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vioplot::vioplot(log(t50), log(n50),</span></span>
<span><span class="co">#                  names = c("log(t)", "log(n)"),</span></span>
<span><span class="co">#                  frame.plot = FALSE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log(n50)</span></span>
<span><span class="co">## W = 0.9854, p-value = 0.6508</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log(n50)</span></span>
<span><span class="co">## t = -7.9572, df = 63, p-value = 4.239e-11</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.9601196 -0.5746763</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##  mean of x </span></span>
<span><span class="co">## -0.7673979</span></span></code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7715268</span></span></code></pre>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span></span>
<span>  <span class="st">"LogMean: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="st">", sd "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>,</span>
<span>  <span class="st">"; Median: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">n50</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="st">", mad "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">n50</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## LogMean: 0.464, sd 0.215, 1; Median: 0.497, mad 0.316</span></span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Different from 1: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nNotOne</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="st">" / "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">nNotOne</span><span class="op">)</span><span class="op">)</span>, <span class="st">": "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">stationaryN</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">" &gt; 1; "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">stationaryN</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">" &lt; 1"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Different from 1: 37 / 64: 2 &gt; 1; 35 &lt; 1</span></span></code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ntBest</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bestNModel</span> <span class="op">==</span> <span class="st">"by_nt_ki"</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bestNModel</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">nModelBF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nProjects</span><span class="op">)</span><span class="op">)</span>, <span class="va">nProjects</span><span class="op">)</span></span>
<span><span class="va">nModelBF</span><span class="op">[</span><span class="va">ntBest</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="va">nProjects</span><span class="op">[</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> </span>
<span>  <span class="va">marginals</span><span class="op">[</span><span class="st">"by_t_ki"</span>, <span class="va">nProjects</span><span class="op">[</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">nModelBF</span><span class="op">[</span><span class="op">!</span><span class="va">ntBest</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="va">nProjects</span><span class="op">[</span><span class="op">!</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> </span>
<span>  <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="va">nProjects</span><span class="op">[</span><span class="op">!</span><span class="va">ntBest</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">nCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">nModelBF</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="va">epsBF</span>, <span class="fl">0</span>, <span class="va">epsBF</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stationaryN</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span>, <span class="va">nModelBF</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Inferred 'n': best stationary model"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"log(Model BF)"</span>, xpd <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>       frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, pch <span class="op">=</span> <span class="fl">4</span>, log <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span>  <span class="va">confidenceCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span></span>
<span>  <span class="va">iqr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryN</span><span class="op">[</span><span class="st">"75%"</span>, <span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">stationaryN</span><span class="op">[</span><span class="st">"25%"</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">stationaryN</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span>, <span class="va">nModelBF</span>, <span class="va">stationaryN</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span>, xpd <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>           col <span class="op">=</span> <span class="va">confidenceCol</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">iqr</span>, breaks <span class="op">=</span> <span class="fl">256</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">stationaryN</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span>, <span class="va">nModelBF</span>, col <span class="op">=</span> <span class="va">nCol</span>,</span>
<span>         pch <span class="op">=</span> <span class="fl">4</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bestNSNModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"ns_n_ki"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"ns_nt_ki"</span>, <span class="op">]</span>,</span>
<span>                       <span class="st">"ns_n_ki"</span>, <span class="st">"ns_nt_ki"</span><span class="op">)</span></span>
<span><span class="va">nsPreferred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"ns_n_ki"</span>, <span class="op">]</span>, <span class="va">marginals</span><span class="op">[</span><span class="st">"ns_nt_ki"</span>, <span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span>, <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">nsPreferredEps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"ns_n_ki"</span>, <span class="op">]</span>, <span class="va">marginals</span><span class="op">[</span><span class="st">"ns_nt_ki"</span>, <span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span>, <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">epsBF</span></span>
<span><span class="va">nsnProjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bestNSNModel</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bestNSNModel</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Estimated value of 1/n and a0 using the best available non-stationary model</span></span>
<span><span class="va">nsnCols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"root_freqs.1."</span>, <span class="st">"rate_loss"</span><span class="op">)</span></span>
<span><span class="va">nsnRet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">6</span>, <span class="fl">2</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.5%"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"97.5%"</span>, <span class="st">"mad"</span><span class="op">)</span>, <span class="va">nsnCols</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsnParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">nsnProjects</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestNSNModel</span><span class="op">[[</span><span class="va">pID</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                            checkRemote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Need results for "</span>, <span class="va">pID</span>, <span class="st">"_"</span>, <span class="va">bestNSNModel</span><span class="op">[</span><span class="va">pID</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="va">bestNSNModel</span><span class="op">[[</span><span class="va">pID</span><span class="op">]</span><span class="op">]</span>, ml <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">params</span><span class="op">[</span>, <span class="va">nsnCols</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="va">nsnRet</span></span>
<span><span class="op">}</span>, <span class="va">nsnRet</span><span class="op">)</span></span>
<span><span class="va">nsN</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">nsnParams</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_loss"</span>, <span class="op">]</span></span>
<span><span class="va">ns25</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">nsnParams</span><span class="op">[</span><span class="st">"25%"</span>, <span class="st">"rate_loss"</span>, <span class="op">]</span></span>
<span><span class="va">ns75</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">nsnParams</span><span class="op">[</span><span class="st">"75%"</span>, <span class="st">"rate_loss"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">nsA0</span> <span class="op">&lt;-</span> <span class="va">nsnParams</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"root_freqs.1."</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">nsN</span><span class="op">)</span>, <span class="va">nsA0</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"% absent at stationary distribution"</span>, ylab <span class="op">=</span> <span class="st">"% absent at root"</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">nsPreferred</span><span class="op">[</span><span class="va">nsnProjects</span><span class="op">]</span> <span class="op">+</span> <span class="va">nsPreferredEps</span><span class="op">[</span><span class="va">nsnProjects</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">nsN</span><span class="op">)</span>, <span class="va">nsnParams</span><span class="op">[</span><span class="st">"25%"</span>, <span class="st">"root_freqs.1."</span>, <span class="op">]</span>,</span>
<span>         <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">nsN</span><span class="op">)</span>, <span class="va">nsnParams</span><span class="op">[</span><span class="st">"75%"</span>, <span class="st">"root_freqs.1."</span>, <span class="op">]</span>,</span>
<span>         col <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">nsPreferred</span><span class="op">[</span><span class="va">nsnProjects</span><span class="op">]</span> <span class="op">+</span> <span class="va">nsPreferredEps</span><span class="op">[</span><span class="va">nsnProjects</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ns25</span><span class="op">)</span>, <span class="va">nsA0</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ns75</span><span class="op">)</span>,</span>
<span>         col <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">nsPreferred</span><span class="op">[</span><span class="va">nsnProjects</span><span class="op">]</span> <span class="op">+</span> <span class="va">nsPreferredEps</span><span class="op">[</span><span class="va">nsnProjects</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, pch <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Stat pref."</span>, <span class="st">"NS pref, &lt; eps"</span>, <span class="st">"Non-Stat pref, &gt; eps"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nsA0</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-9-2.png" width="672"></p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Which variables predict support for a model with a free n?</span></span>
<span><span class="va">nProj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nModelBF</span><span class="op">)</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="va">nModelBF</span>,</span>
<span>  nChar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span>, <span class="va">nProj</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  nTrans <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="va">nProj</span><span class="op">]</span>,</span>
<span>  nNeo <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="va">nProj</span><span class="op">]</span>,</span>
<span>  logNTRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="va">nProj</span><span class="op">]</span> <span class="op">/</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="va">nProj</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  charPerTax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span>, <span class="va">nProj</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="va">nProj</span><span class="op">]</span>,</span>
<span>  taxon <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="va">nProj</span><span class="op">]</span>,</span>
<span>  rank <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">rank</span><span class="op">[</span><span class="va">nProj</span><span class="op">]</span>,</span>
<span>  nTaxa <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="va">nProj</span><span class="op">]</span>,</span>
<span>  inferredN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">stationaryN</span><span class="op">[</span>, <span class="va">nProj</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">nPredictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nChar"</span>, <span class="st">"logNTRatio"</span>, <span class="st">"charPerTax"</span>, <span class="st">"taxon"</span>, <span class="st">"rank"</span>, <span class="st">"nTaxa"</span>,</span>
<span>                 <span class="st">"inferredN.50."</span><span class="op">)</span></span>
<span><span class="va">vsurfBF</span> <span class="op">&lt;-</span> <span class="fu">VSURF</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/VSURF/man/VSURF.html" class="external-link">VSURF</a></span><span class="op">(</span><span class="va">meta</span><span class="op">[</span>, <span class="va">nPredictors</span><span class="op">]</span>, <span class="va">nModelBF</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predBF</span> <span class="op">&lt;-</span> <span class="va">nPredictors</span><span class="op">[</span><span class="va">vsurfBF</span><span class="op">[[</span><span class="st">"varselect.interp"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">predBF</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## inferredN.50., nChar, logNTRatio</span></span></code></pre>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rfBF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">meta</span><span class="op">[</span>, <span class="va">predBF</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="va">nModelBF</span>,</span>
<span>                     ntree <span class="op">=</span> <span class="fl">10000</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">rfBF</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                %IncMSE IncNodePurity</span></span>
<span><span class="co">## inferredN.50. 84.33009      7607.976</span></span>
<span><span class="co">## nChar         91.74561      6318.463</span></span>
<span><span class="co">## logNTRatio    52.96062      7281.780</span></span></code></pre>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html" class="external-link">varImpPlot</a></span><span class="op">(</span><span class="va">rfBF</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">predBF</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nPred</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">predictor</span> <span class="kw">in</span> <span class="va">predBF</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/partialPlot.html" class="external-link">partialPlot</a></span><span class="op">(</span><span class="va">rfBF</span>, <span class="va">meta</span><span class="op">[</span>, <span class="va">nPredictors</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span>,</span>
<span>              frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nModelBF</span> <span class="op">~</span> <span class="va">meta</span><span class="op">[</span>, <span class="va">predictor</span><span class="op">]</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="va">predictor</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-11-2.png" width="576"></p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metaN</span> <span class="op">&lt;-</span> <span class="va">meta</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">meta</span><span class="op">[</span>, <span class="st">"inferredN.50."</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">n50</span> <span class="op">&lt;-</span> <span class="va">metaN</span><span class="op">[</span>, <span class="st">"inferredN.50."</span><span class="op">]</span></span>
<span><span class="va">vsurfN</span> <span class="op">&lt;-</span> <span class="fu">VSURF</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/VSURF/man/VSURF.html" class="external-link">VSURF</a></span><span class="op">(</span><span class="va">metaN</span><span class="op">[</span>, <span class="va">nPredictors</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n50</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">predN</span> <span class="op">&lt;-</span> <span class="va">nPredictors</span><span class="op">[</span><span class="va">vsurfN</span><span class="op">[[</span><span class="st">"varselect.interp"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">predN</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## inferredN.50.</span></span></code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Expect this to be zero, or perhaps higher taxon</span></span>
<span><span class="va">rfT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">metaT</span><span class="op">[</span>, <span class="va">tPredictors</span><span class="op">[</span><span class="va">vsurfT</span><span class="op">[[</span><span class="st">"varselect.pred"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    <span class="va">t50</span>,</span>
<span>                    ntree <span class="op">=</span> <span class="fl">10000</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html" class="external-link">varImpPlot</a></span><span class="op">(</span><span class="va">rfT</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-11-3.png" width="576"></p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/partialPlot.html" class="external-link">partialPlot</a></span><span class="op">(</span><span class="va">rfT</span>, <span class="va">metaT</span>, <span class="va">logNTRatio</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t50</span> <span class="op">~</span> <span class="va">metaT</span><span class="op">$</span><span class="va">logNTRatio</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 9 y values &lt;= 0 omitted from</span></span>
<span><span class="co">## logarithmic plot</span></span></code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-11-4.png" width="576"></p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/partialPlot.html" class="external-link">partialPlot</a></span><span class="op">(</span><span class="va">rfT</span>, <span class="va">metaT</span>, <span class="va">nTaxa</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t50</span> <span class="op">~</span> <span class="va">metaT</span><span class="op">$</span><span class="va">nTaxa</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 9 y values &lt;= 0 omitted from</span></span>
<span><span class="co">## logarithmic plot</span></span></code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-11-5.png" width="576"></p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="op">]</span>, <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="op">]</span>,</span>
<span>     pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">epsBF</span>, <span class="fl">16</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="va">mk2Col</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Transformational characters"</span>, ylab <span class="op">=</span> <span class="st">"Neomorphic characters"</span>,</span>
<span>     log <span class="op">=</span> <span class="st">"xy"</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mk2 preferred"</span>, <span class="st">"&gt; eps"</span>, <span class="st">"&lt;= eps"</span>,  <span class="st">"mk preferred"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>, pt.cex <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">)</span>, <span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span>,</span>
<span>     pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">epsBF</span>, <span class="fl">16</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="va">mk2Col</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Characters"</span>, ylab <span class="op">=</span> <span class="st">"Taxa"</span>,</span>
<span>     log <span class="op">=</span> <span class="st">"xy"</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): graphical</span></span>
<span><span class="co">## parameter "type" is obsolete</span></span></code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mk preferred"</span>, <span class="st">"&lt;eps"</span>, <span class="st">"&lt;eps"</span>, <span class="st">"mk2 preferred"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>, pt.cex <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Red-Green"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-12-2.png" width="576"></p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">mk2</span> <span class="op">~</span> <span class="va">.meta</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mk2</span><span class="op">)</span><span class="op">]</span>, las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, ylab <span class="op">=</span> <span class="st">"MK2 BF"</span>, notch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="../reference/TaxonCol.html">TaxonCol</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in (function (z, notch = FALSE, width = NULL, varwidth = FALSE, : some</span></span>
<span><span class="co">## notches went outside hinges ('box'): maybe set notch=FALSE</span></span></code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/SpindleCompare.html">SpindleCompare</a></span><span class="op">(</span><span class="st">"by_nn_ki"</span>, <span class="st">"by_n_ki"</span>, <span class="va">marginals</span>, <span class="va">stdErr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          better worse  n</span></span>
<span><span class="co">## by_nn_ki      8     7 64</span></span></code></pre>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nnWins</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span> <span class="op">-</span></span>
<span>                          <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span>,</span>
<span>                        <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">nWins</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span> <span class="op">-</span></span>
<span>                         <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span>,</span>
<span>                       <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nnWins</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 23</span></span></code></pre>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nWins</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 15</span></span></code></pre>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span>,</span>
<span>              <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Similar to by_t_ki vs by_ki</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 20</span></span></code></pre>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span>,</span>
<span>              <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nt_ki"</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   104   157   175   450   493   563   635   675   692   706   748   950  1113 </span></span>
<span><span class="co">## FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE </span></span>
<span><span class="co">##  1210  1271  2131  2553  2800  3199  3200  3244  3351  3392  3405  3408  3445 </span></span>
<span><span class="co">## FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE </span></span>
<span><span class="co">##  3448  3603  3646  3655  3705  3710  3711  3755  3757  3804  3832  3833  3927 </span></span>
<span><span class="co">## FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE </span></span>
<span><span class="co">##  3929  4111  4220  4230  4291  4305  4308  4309  4310  4467  4649  4747  4761 </span></span>
<span><span class="co">## FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE </span></span>
<span><span class="co">##  4790  4867  4910  5099  5186  5201  5228  5230  5255  5268  5327 07203 </span></span>
<span><span class="co">## FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE</span></span></code></pre>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span>,</span>
<span>              <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8</span></span></code></pre>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span>,</span>
<span>              <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7</span></span></code></pre>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span> <span class="op">~</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">stdErr</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span><span class="op">)</span>, frame <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span>,</span>
<span>     <span class="va">marginals</span><span class="op">[</span><span class="st">"by_nn_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_n_ki"</span>, <span class="op">]</span>,</span>
<span>     frame <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="st">"by_nn_ki"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">)</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"by_ki"</span>, <span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Advantage over StMk"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-16-2.png" width="672"></p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"by_nn_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">[</span>, <span class="st">"rate01"</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span>, <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="fl">450</span>, <span class="st">"by_nn_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="st">"rate01"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">medN</span> <span class="op">&lt;-</span> <span class="va">rate01</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">medN</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-16-3.png" width="672"></p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">medN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.422601</span></span></code></pre>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">medN</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log(medN)</span></span>
<span><span class="co">## W = 0.97338, p-value = 0.1811</span></span></code></pre>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">medN</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##  -2.910  -1.420  -0.885  -0.931  -0.380   1.070</span></span></code></pre>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">medN</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.88</span></span></code></pre>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">medN</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.768</span></span></code></pre>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">medN</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log(medN)</span></span>
<span><span class="co">## t = -8.4633, df = 63, p-value = 5.539e-12</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -1.1504659 -0.7109511</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##  mean of x </span></span>
<span><span class="co">## -0.9307085</span></span></code></pre>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#sum(rate01["97.5%", ] &lt; 1, na.rm = TRUE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"_n_ differs from unity (w/ pp &gt; 95%) in "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rate01</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">rate01</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span> <span class="op">&gt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="st">" of "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">medN</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="st">" datasets, and is less than one in "</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rate01</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="st">" of these"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## _n_ differs from unity (w/ pp &gt; 95%) in 41 of 64 datasets, and is less than one in 39 of these</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="non-stationarity">Non-stationarity<a class="anchor" aria-label="anchor" href="#non-stationarity"></a>
</h2>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelsNS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by_ki"</span>, <span class="st">"by_n_ki"</span>, <span class="st">"by_nt_ki"</span>,</span>
<span>              <span class="st">"ns_ki"</span>, <span class="st">"ns_n_ki"</span>, <span class="st">"ns_nt_ki"</span><span class="op">)</span></span>
<span><span class="va">marginals</span> <span class="op">&lt;-</span> <span class="fu">GetMarginals</span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsNS</span><span class="op">)</span></span>
<span><span class="va">stdErr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">marginals</span>, <span class="st">"stdErr"</span><span class="op">)</span></span>
<span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MarginalDiffs.html">MarginalDiffs</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsNS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/setup-ns-1.png" width="672"></p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stdErr</span>, <span class="va">mds</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Standard error of estimate"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Difference, stepping stone vs path sampling estimates"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsNS</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="../reference/ModelLabel.html">ModelLabel</a></span><span class="op">(</span><span class="va">modelsNS</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsNS</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/setup-ns-2.png" width="672"></p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"ns_nt_ki"</span>, <span class="st">"by_nt_ki"</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 14</span></span></code></pre>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"by_ki"</span>, <span class="st">"ns_ki"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bestS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span><span class="va">bestNS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bestML_S</span>  <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bestS</span>,  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">bestML_NS</span> <span class="op">&lt;-</span> <span class="va">marginals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="va">bestNS</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">bestSE_S</span>  <span class="op">&lt;-</span> <span class="va">stdErr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bestS</span>,  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">bestSE_NS</span> <span class="op">&lt;-</span> <span class="va">stdErr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="va">bestNS</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># When does the best non-stationary model outperform the best stat?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">bestML_NS</span> <span class="op">-</span> <span class="va">bestML_S</span>, <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">bestSE_S</span>, <span class="va">bestSE_NS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 11</span></span></code></pre>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># When does the best stationary model outperform the best non-stat?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">bestML_S</span> <span class="op">-</span> <span class="va">bestML_NS</span>, <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">bestSE_S</span>, <span class="va">bestSE_NS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6</span></span></code></pre>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bestML_NS</span> <span class="op">-</span> <span class="va">bestML_S</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>,</span>
<span>                      <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    ns_ki  ns_n_ki ns_nt_ki </span></span>
<span><span class="co">##       16       11       14</span></span></code></pre>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span>,</span>
<span>                      <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    by_ki  by_n_ki by_nt_ki </span></span>
<span><span class="co">##        3        6        6</span></span></code></pre>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For which analyses are results available?</span></span>
<span><span class="va">allIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="va">someIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Take parameter values from the best non-stationary and stationary models</span></span>
<span><span class="va">nsPref</span> <span class="op">&lt;-</span> <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="va">bestML_NS</span> <span class="op">-</span> <span class="va">bestML_S</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nullParam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`2.5%` <span class="op">=</span> <span class="cn">NA_real_</span>, `25%` <span class="op">=</span> <span class="cn">NA_real_</span>, `50%` <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>               `75%` <span class="op">=</span> <span class="cn">NA_real_</span>, `97.5%` <span class="op">=</span> <span class="cn">NA_real_</span>, mad <span class="op">=</span> <span class="cn">NA_real_</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bestS</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bestNS</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">modelsNS</span><span class="op">[</span><span class="fl">3</span> <span class="op">+</span> <span class="va">bestNS</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>                  <span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="st">"root_freqs.1."</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="va">nullParam</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">nsValue</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bestS</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Is the median root frequency different from zero?</span></span>
<span><span class="co"># For results that include also ns_t_ki, see 5_Parameters.R</span></span>
<span><span class="co"># The values there (not here) are used for publication</span></span>
<span><span class="va">ns50</span> <span class="op">&lt;-</span> <span class="va">nsValue</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span></span>
<span><span class="va">a0</span> <span class="op">&lt;-</span> <span class="va">nsValue</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">nsValue</span><span class="op">)</span></span>
<span><span class="va">f01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a0</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f01</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##  0.3019  1.0843  2.1305  2.1272  3.1420 37.4638</span></span></code></pre>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">f01</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.992544</span></span></code></pre>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">f01</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.8427146</span></span></code></pre>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vioplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vioplot/man/vioplot.html" class="external-link">vioplot</a></span><span class="op">(</span><span class="va">f01</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">f01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  f01</span></span>
<span><span class="co">## W = 0.95953, p-value = 0.03456</span></span></code></pre>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/skewness.html" class="external-link">skewness</a></span><span class="op">(</span><span class="va">f01</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6754709</span></span></code></pre>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">f01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  f01</span></span>
<span><span class="co">## t = 6.0839, df = 63, p-value = 7.638e-08</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.5068888 1.0027491</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">##  0.754819</span></span></code></pre>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary statistics for best model</span></span>
<span><span class="va">a2.5</span> <span class="op">&lt;-</span> <span class="va">a0</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span></span>
<span><span class="va">a97.5</span> <span class="op">&lt;-</span> <span class="va">a0</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a2.5</span> <span class="op">&gt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 25</span></span></code></pre>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a97.5</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a2.5</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">a97.5</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 28</span></span></code></pre>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">a2.5</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">a97.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Repeat, using a single model throughout.  The results turn out to be similar.</span></span>
<span><span class="co"># Take parameter values from NstMk</span></span>
<span><span class="va">nsValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_ki"</span></span>
<span>                  <span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="st">"root_freqs.1."</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="va">nullParam</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ns2.5</span> <span class="op">&lt;-</span> <span class="va">nsValue</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span></span>
<span><span class="va">ns50</span> <span class="op">&lt;-</span> <span class="va">nsValue</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span></span>
<span><span class="va">ns97.5</span> <span class="op">&lt;-</span> <span class="va">nsValue</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span></span>
<span><span class="va">a2.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ns2.5</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ns2.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ns50</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ns50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a97.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ns97.5</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ns97.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a2.5</span> <span class="op">&gt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a97.5</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 25</span></span></code></pre>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a2.5</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">a97.5</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30</span></span></code></pre>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">a2.5</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">a97.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">ns50</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.614058</span></span></code></pre>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">a50</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.487682</span></span></code></pre>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take parameter values from NstN</span></span>
<span><span class="va">nsnValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_n_ki"</span></span>
<span>                  <span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="st">"root_freqs.1."</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="va">nullParam</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsn2.5</span> <span class="op">&lt;-</span> <span class="va">nsnValue</span><span class="op">[</span><span class="st">"2.5%"</span>, <span class="op">]</span></span>
<span><span class="va">nsn50</span> <span class="op">&lt;-</span> <span class="va">nsnValue</span><span class="op">[</span><span class="st">"50%"</span>, <span class="op">]</span></span>
<span><span class="va">nsn97.5</span> <span class="op">&lt;-</span> <span class="va">nsnValue</span><span class="op">[</span><span class="st">"97.5%"</span>, <span class="op">]</span></span>
<span><span class="va">an2.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">nsn2.5</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">nsn2.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">an50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">nsn50</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">nsn50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">an97.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">nsn97.5</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">nsn97.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">an2.5</span> <span class="op">&gt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">an97.5</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 20</span></span></code></pre>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">an2.5</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">an97.5</span> <span class="op">&lt;</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 25</span></span></code></pre>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">an2.5</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">an97.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">ns50</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.614058</span></span></code></pre>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">a50</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.487682</span></span></code></pre>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Can we predict which projects will benefit from a non-stationary model?</span></span>
<span><span class="va">nsProj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nsPref</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bestS</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">nsValue</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">nsMeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  nsProj <span class="op">=</span> <span class="va">nsPref</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span>,</span>
<span>  nChar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span>, <span class="va">nsProj</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  nTrans <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="va">nsProj</span><span class="op">]</span>,</span>
<span>  nNeo <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="va">nsProj</span><span class="op">]</span>,</span>
<span>  logNTRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"neo"</span>, <span class="va">nsProj</span><span class="op">]</span> <span class="op">/</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span><span class="st">"trans"</span>, <span class="va">nsProj</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  charPerTax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">.meta</span><span class="op">$</span><span class="va">nChar</span><span class="op">[</span>, <span class="va">nsProj</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span>,</span>
<span>  rank <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">rank</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span>,</span>
<span>  taxon <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span>,</span>
<span>  nTaxa <span class="op">=</span> <span class="va">.meta</span><span class="op">$</span><span class="va">nTaxa</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span>,</span>
<span>  <span class="co"># nsValue = t(nsValue[, nsProj]), --&gt; a0Value</span></span>
<span>  a0Value <span class="op">=</span> <span class="va">nsValue</span><span class="op">[</span><span class="st">"50%"</span>, <span class="va">nsProj</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">nsValue</span><span class="op">[</span><span class="st">"50%"</span>, <span class="va">nsProj</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsPredictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nChar"</span>, <span class="st">"logNTRatio"</span>, <span class="st">"charPerTax"</span>, <span class="st">"rank"</span>,</span>
<span>                  <span class="st">"taxon"</span>, <span class="st">"nTaxa"</span>, <span class="st">"a0Value"</span><span class="op">)</span></span>
<span><span class="va">vsurfBF</span> <span class="op">&lt;-</span> <span class="fu">VSURF</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/VSURF/man/VSURF.html" class="external-link">VSURF</a></span><span class="op">(</span><span class="va">nsMeta</span><span class="op">[</span>, <span class="va">nsPredictors</span><span class="op">]</span>, <span class="va">nsPref</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">predBF</span> <span class="op">&lt;-</span> <span class="va">nsPredictors</span><span class="op">[</span><span class="va">vsurfBF</span><span class="op">[[</span><span class="st">"varselect.interp"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">predBF</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## a0Value, logNTRatio</span></span></code></pre>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rfBF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">nsMeta</span><span class="op">[</span>, <span class="va">predBF</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="va">nsPref</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span>,</span>
<span>                     ntree <span class="op">=</span> <span class="fl">10000</span>, importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">rfBF</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             %IncMSE IncNodePurity</span></span>
<span><span class="co">## a0Value    46.64575      481.7741</span></span>
<span><span class="co">## logNTRatio 26.13554      441.3499</span></span></code></pre>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html" class="external-link">varImpPlot</a></span><span class="op">(</span><span class="va">rfBF</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">predBF</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Values of the root distribution that are uneven correspond to better support</span></span>
<span><span class="co"># for non-stationary models.  This matches intuition.</span></span>
<span><span class="co"># There is a prominent step where &gt;250 characters suddenly give strong</span></span>
<span><span class="co"># support for NS models.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nPred</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">predictor</span> <span class="kw">in</span> <span class="va">predBF</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/partialPlot.html" class="external-link">partialPlot</a></span><span class="op">(</span><span class="va">rfBF</span>, <span class="va">nsMeta</span><span class="op">[</span>, <span class="va">nsPredictors</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nsPref</span><span class="op">[</span><span class="va">nsProj</span><span class="op">]</span> <span class="op">~</span> <span class="va">nsMeta</span><span class="op">[</span>, <span class="va">predictor</span><span class="op">]</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="va">predictor</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/EpsLine.html">EpsLine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/unnamed-chunk-20-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="heterogeneous-models">Heterogeneous models<a class="anchor" aria-label="anchor" href="#heterogeneous-models"></a>
</h2>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelsHet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by_ki"</span>, <span class="st">"by_n_ki"</span>, <span class="st">"by_nt_ki"</span>,</span>
<span>               <span class="st">"ns_ki"</span>, <span class="st">"ns_n_ki"</span>, <span class="st">"ns_nt_ki"</span>,</span>
<span>               <span class="st">"hg_ki"</span>, <span class="st">"hg2_ki"</span>, <span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span></span>
<span><span class="va">marginals</span> <span class="op">&lt;-</span> <span class="fu">GetMarginals</span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsHet</span><span class="op">)</span></span>
<span><span class="va">stdErr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">marginals</span>, <span class="st">"stdErr"</span><span class="op">)</span></span>
<span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MarginalDiffs.html">MarginalDiffs</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">modelsHet</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/setup-het-1.png" width="672"></p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stdErr</span>, <span class="va">mds</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Standard error of estimate"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Difference, stepping stone vs path sampling estimates"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsHet</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="../reference/ModelLabel.html">ModelLabel</a></span><span class="op">(</span><span class="va">modelsHet</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/ModelCol.html">ModelCol</a></span><span class="op">(</span><span class="va">modelsHet</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-analysis_files/figure-html/setup-het-2.png" width="672"></p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Which analyses are complete and have results available?</span></span>
<span><span class="va">someIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">6</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span><span class="va">bestNH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="va">someIn</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span><span class="va">bestHet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fl">6</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="va">someIn</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span><span class="va">hetPref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bestHet</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">marginals</span><span class="op">[</span><span class="fl">6</span> <span class="op">+</span> <span class="va">bestHet</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">someIn</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="va">bestNH</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">someIn</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">hetErr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bestHet</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/dot-DiffErr.html">.DiffErr</a></span><span class="op">(</span><span class="va">stdErr</span><span class="op">[</span><span class="fl">6</span> <span class="op">+</span> <span class="va">bestHet</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">someIn</span><span class="op">]</span>, <span class="va">stdErr</span><span class="op">[</span><span class="va">bestNH</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">someIn</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Does the best het model beat the best homogeneous?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="va">hetPref</span>, <span class="va">hetErr</span>, <span class="va">epsBF</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 28</span></span></code></pre>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/dot-OutwithError.html">.OutwithError</a></span><span class="op">(</span><span class="op">-</span><span class="va">hetPref</span>, <span class="va">hetErr</span>, <span class="va">epsBF</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 14</span></span></code></pre>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">hetPref</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Does allowing heterogeneity in transformational improve fit?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_ki"</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>            <span class="co"># 28</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 29</span></span></code></pre>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_ki"</span>, <span class="st">"hg2_ki"</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>            <span class="co"># 4</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4</span></span></code></pre>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="st">"hg2_ki"</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">marginals</span><span class="op">[</span><span class="st">"hg_ki"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># 64</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 64</span></span></code></pre>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Does modelling distinct heterogeneity behaviour in Neo vs Trans improve fit?</span></span>
<span><span class="va">hg2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span></span>
<span><span class="co"># Which analyses have results available?</span></span>
<span><span class="va">hgsIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="va">hg2s</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hgsIn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 62</span></span></code></pre>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hbPref</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg2_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="va">hmPref</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg2_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="va">hbmPref</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg2_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="co"># Which of the bm models are best?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hg2s</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="va">hg2s</span>, <span class="va">hgsIn</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  hg_b_ki hg_bm_ki  hg_m_ki </span></span>
<span><span class="co">##       23       15       24</span></span></code></pre>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How often does the best bm model outperform hg2?</span></span>
<span><span class="va">hg2Pref</span> <span class="op">&lt;-</span> <span class="va">hbPref</span> <span class="op">|</span> <span class="va">hmPref</span> <span class="op">|</span> <span class="va">hbmPref</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hg2Pref</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8</span></span></code></pre>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How often does hg2 outperform all bm models?</span></span>
<span><span class="va">hbXPref</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="va">hmXPref</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="va">hbmXPref</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hbXPref</span> <span class="op">&amp;</span> <span class="va">hmXPref</span> <span class="op">&amp;</span> <span class="va">hbmXPref</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hg1Best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hg1Best</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hg1Pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">|</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">|</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg2_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hg1Pref</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 11</span></span></code></pre>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">hg2Pref</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 62</span></span></code></pre>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ABest</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">contenders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="va">betterThanB</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">a</span>, <span class="va">contenders</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="va">betterThanC</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">a</span>, <span class="va">contenders</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="va">worseThanB</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">contenders</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="va">worseThanC</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">contenders</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">" is best in "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">betterThanB</span> <span class="op">|</span> <span class="va">betterThanC</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">worseThanB</span> <span class="op">|</span> <span class="va">worseThanC</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="st">" and worst in "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">worseThanB</span> <span class="op">|</span> <span class="va">worseThanC</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">betterThanB</span> <span class="op">|</span> <span class="va">betterThanC</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ABestStrict</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">contenders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="va">betterThanB</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">a</span>, <span class="va">contenders</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="va">betterThanC</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">a</span>, <span class="va">contenders</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="va">worseThanB</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">contenders</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="va">worseThanC</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="va">contenders</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">" is best in "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">betterThanB</span> <span class="op">&amp;</span> <span class="va">betterThanC</span><span class="op">)</span>,</span>
<span>          <span class="st">" and worst in "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">worseThanB</span> <span class="op">&amp;</span> <span class="va">worseThanC</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 47</span></span></code></pre>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ABest</span><span class="op">(</span><span class="st">"hg_b_ki"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## hg_b_ki is best in 7 and worst in 5</span></span></code></pre>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ABest</span><span class="op">(</span><span class="st">"hg_bm_ki"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## hg_bm_ki is best in 4 and worst in 8</span></span></code></pre>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ABest</span><span class="op">(</span><span class="st">"hg_m_ki"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## hg_m_ki is best in 8 and worst in 6</span></span></code></pre>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ABestStrict</span><span class="op">(</span><span class="st">"hg_b_ki"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## hg_b_ki is best in 3 and worst in 1</span></span></code></pre>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ABestStrict</span><span class="op">(</span><span class="st">"hg_bm_ki"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## hg_bm_ki is best in 0 and worst in 2</span></span></code></pre>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ABestStrict</span><span class="op">(</span><span class="st">"hg_m_ki"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## hg_m_ki is best in 1 and worst in 1</span></span></code></pre>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4</span></span></code></pre>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4</span></span></code></pre>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hg2Same</span> <span class="op">&lt;-</span> <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">|</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">|</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_b_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">|</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">|</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_m_ki"</span>, <span class="st">"hg_bm_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span> <span class="op">|</span></span>
<span>  <span class="fu">.ErrCompare</span><span class="op">(</span><span class="st">"hg_bm_ki"</span>, <span class="st">"hg_m_ki"</span><span class="op">)</span><span class="op">[</span><span class="va">hgsIn</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"HG b/m models indistinguishable from one another in "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hg2Same</span><span class="op">)</span>, <span class="st">" / "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">hgsIn</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## HG b/m models indistinguishable from one another in 15 / 64</span></span></code></pre>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hg2s</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="va">hg2s</span>, <span class="va">hgsIn</span><span class="op">]</span><span class="op">[</span>, <span class="op">!</span><span class="va">hg2Same</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  hg_b_ki hg_bm_ki  hg_m_ki </span></span>
<span><span class="co">##       17       12       18</span></span></code></pre>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hg2s</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">marginals</span><span class="op">[</span><span class="va">hg2s</span>, <span class="va">hgsIn</span><span class="op">]</span><span class="op">[</span>, <span class="op">!</span><span class="va">hg2Same</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">which.min</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  hg_b_ki hg_bm_ki  hg_m_ki </span></span>
<span><span class="co">##       12       17       18</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin R. Smith.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
