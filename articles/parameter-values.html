<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parameter value summary â€¢ neotrans</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Parameter value summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">neotrans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2025-11-06</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/compare-trees.html">Impact of model choice on tree topologies</a>
    </li>
    <li>
      <a href="../articles/install.html">Install the neotrans package</a>
    </li>
    <li>
      <a href="../articles/matrix-processing.html">Annotate matrices</a>
    </li>
    <li>
      <a href="../articles/model-cost.html">Compuational cost of models</a>
    </li>
    <li>
      <a href="../articles/model-pairs.html">Comparison of model pairs</a>
    </li>
    <li>
      <a href="../articles/parameter-analysis.html">Parameter analysis</a>
    </li>
    <li>
      <a href="../articles/parameter-values.html">Parameter value summary</a>
    </li>
    <li>
      <a href="../articles/predictions.html">Predicting parameters and fit</a>
    </li>
    <li>
      <a href="../articles/prior-posterior.html">Prior-posterior comparison</a>
    </li>
    <li>
      <a href="../articles/stationarity.html">Evaluating stationarity</a>
    </li>
    <li>
      <a href="../articles/wct-comparison.html">Comparison to well-corroborated trees</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ms609/neotrans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Parameter value summary</h1>
                        <h4 data-toc-skip class="author">Martin R. Smith
<a href="mailto:martin.smith@durham.ac.uk" class="email">martin.smith@durham.ac.uk</a>
</h4>
            
            <h4 data-toc-skip class="date">2025-11-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ms609/neotrans/blob/main/vignettes/parameter-values.Rmd" class="external-link"><code>vignettes/parameter-values.Rmd</code></a></small>
      <div class="hidden name"><code>parameter-values.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/neotrans/" class="external-link">"neotrans"</a></span><span class="op">)</span></span>
<span><span class="va">modelsT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"by_ki"</span>, <span class="st">"by_n_ki"</span>, <span class="st">"by_t_ki"</span>, <span class="st">"by_nt_ki"</span>, <span class="st">"rm_by_t_ki"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rateT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  by_t_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"by_t_ki"</span>,</span>
<span>                      checkRemote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_neo"</span><span class="op">]</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by_nt_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"by_nt_ki"</span>,</span>
<span>                      checkRemote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_neo"</span><span class="op">]</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ns_t_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_t_ki"</span>,</span>
<span>                      checkRemote <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_neo"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="op">{</span></span>
<span>                        <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_t_ki"</span><span class="op">)</span>; <span class="cn">NA_real_</span><span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ns_nt_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_nt_ki"</span>,</span>
<span>                      checkRemote <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_neo"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="op">{</span></span>
<span>                        <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_nt_ki"</span><span class="op">)</span>; <span class="cn">NA_real_</span><span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in .GitClone(pID, scriptID): Cloning into '/home/runner/work/_temp/Library/revbayes-repos/748_ns_t_ki'...</span></span>
<span><span class="co">##   fatal: could not read Username for 'https://github.com': terminal prompts disabled</span></span>
<span><span class="co">## Warning in .GitClone(pID, scriptID): Cloning into '/home/runner/work/_temp/Library/revbayes-repos/748_ns_t_ki'...</span></span>
<span><span class="co">##   fatal: could not read Username for 'https://github.com': terminal prompts disabled</span></span></code></pre>
<pre><code><span><span class="co">## Warning in .GitClone(pID, scriptID): Cloning into '/home/runner/work/_temp/Library/revbayes-repos/4867_ns_t_ki'...</span></span>
<span><span class="co">##   fatal: could not read Username for 'https://github.com': terminal prompts disabled</span></span>
<span><span class="co">## Warning in .GitClone(pID, scriptID): Cloning into '/home/runner/work/_temp/Library/revbayes-repos/4867_ns_t_ki'...</span></span>
<span><span class="co">##   fatal: could not read Username for 'https://github.com': terminal prompts disabled</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">root0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ns_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"root_freqs.1."</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span></span>
<span>      <span class="cn">NA_real_</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ns_n_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_n_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"root_freqs.1."</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_n_ki"</span><span class="op">)</span>; <span class="cn">NA_real_</span><span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ns_t_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_n_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"root_freqs.1."</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_n_ki"</span><span class="op">)</span>; <span class="cn">NA_real_</span><span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ns_nt_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_nt_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"root_freqs.1."</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/MakeSlurm.html">MakeSlurm</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_nt_ki"</span><span class="op">)</span>; <span class="cn">NA_real_</span><span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">a0</span> <span class="op">&lt;-</span> <span class="va">root0</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">root0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rate01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  by_n_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"by_n_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fl">1</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_loss"</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by_nn_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"by_nn_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">x</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate01"</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by_nt_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"by_nt_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fl">1</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_loss"</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ns_n_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_n_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fl">1</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_loss"</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ns_nt_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"ns_nt_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fl">1</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"rate_loss"</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  hg_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"hg_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"mean_n"</span><span class="op">]</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  hg_b_ki <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pID</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ExistingResults.html">ExistingResults</a></span><span class="op">(</span><span class="va">pID</span>, <span class="st">"hg_b_ki"</span><span class="op">)</span><span class="op">[[</span><span class="st">"parameters"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"50%"</span>, <span class="st">"mean_n"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="cn">NA_real_</span></span>
<span>  <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/OutputPlot.html">OutputPlot</a></span><span class="op">(</span><span class="st">"param_values"</span>, width <span class="op">=</span> <span class="fl">7.2</span>, height <span class="op">=</span> <span class="fl">6</span>, <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.6</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/SpindlePlot.html">SpindlePlot</a></span><span class="op">(</span><span class="va">rateT</span>, log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative transformational rate,"</span> <span class="op">~</span></span>
<span>                                  <span class="fu">italic</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              Behind <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/Panel.html">Panel</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/SpindlePlot.html">SpindlePlot</a></span><span class="op">(</span><span class="va">a0</span>, log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Proportion of absences at root,"</span> <span class="op">~</span> <span class="fu">italic</span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>,</span>
<span>              Behind <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/Panel.html">Panel</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/SpindlePlot.html">SpindlePlot</a></span><span class="op">(</span><span class="va">rate01</span>, frame.plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Rate of gain relative to loss,"</span> <span class="op">~</span> <span class="fu">italic</span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              log <span class="op">=</span> <span class="st">"y"</span>, width <span class="op">=</span> <span class="fl">2.1</span>,</span>
<span>              Behind <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span>              <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/Panel.html">Panel</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-values_files/figure-html/plot-values-1.png" width="691.2">
## Summarize values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>0</mn></msub><annotation encoding="application/x-tex">a_0</annotation></semantics></math></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">root0</span><span class="op">)</span></span>
<span><span class="va">nsBF</span> <span class="op">&lt;-</span> <span class="fu">GetMarginals</span><span class="op">(</span><span class="fu"><a href="../reference/KiProjects.html">KiProjects</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">nsModels</span><span class="op">)</span></span>
<span><span class="va">bestNS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">nsBF</span>, <span class="fl">2</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span><span class="va">a0Best</span> <span class="op">&lt;-</span> <span class="va">a0</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bestNS</span><span class="op">)</span>, <span class="va">bestNS</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a0Best</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log(a0Best)</span></span>
<span><span class="co">## W = 0.95781, p-value = 0.02821</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/skewness.html" class="external-link">skewness</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a0Best</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6404754</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">a0Best</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.877446</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a0Best</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># log-mean</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.121659</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">a0Best</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.224176</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">a0Best</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.5539</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">a0Best</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  a0Best</span></span>
<span><span class="co">## t = 4.9337, df = 63, p-value = 6.207e-06</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  2.306932 5.447960</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">##  3.877446</span></span></code></pre>
<!--

# TODO the below needs updating to correctly convert parameters to _n_ equivalent.
modelsP <- c("by_ki", "by_n_ki", "by_nn_ki", "by_t_ki", "by_nt_ki", "ns_ki",
             "ns_n_ki", "ns_nt_ki", "hg_ki", "hg2_ki")
marginals <- GetMarginals(KiProjects(), modelsP)
stdErr <- attr(marginals, "stdErr")

nModels <- c("by_n_ki", "by_nn_ki", "by_nt_ki")
mlAvailable <- ModelBF(marginals, nModels)
projects <- colnames(mlAvailable)
unavailable <- setdiff(KiProjects(), projects)
if (length(unavailable)) {
  warning("Not plotting ", paste0(unavailable, collapse = ", "),
          ": some results unavailable")
}
whichModel <- nModels[apply(mlAvailable, 2, which.max)]

nullParam <- c(`2.5%` = NA_real_, `25%` = NA_real_, `50%` = NA_real_,
               `75%` = NA_real_, `97.5%` = NA_real_, mad = NA_real_)

# Estimated values of n under by_n_ki
nVal <- lapply(nModels, function(model) {
  sapply(KiProjects(), function(pID) {
    res <- ExistingResults(pID, model, checkRemote = FALSE)[["parameters"]][, "rate_loss"]
    if (is.null(res)) {
      message("Need results for ", pID, "_", model)
      UpdateRecords(pID, model)
      res <- ExistingResults(pID, model, checkRemote = TRUE)[["parameters"]]
      if (!HasConverged(pID, model)) {
        MakeSlurm(pID, model, ml = FALSE)
      }
    }
    res %||% nullParam
  })
}) |> setNames(nModels)

stationaryN <- matrix(NA, nrow = 6, ncol = length(projects), dimnames = list(
  c("2.5%", "25%", "50%", "75%", "97.5%", "mad"),
  projects))
nonStatN <- stationaryN


# Compare estimated values of n
# Beware: rate_loss = 1 / n
nModels <- c("by_n_ki", "by_nt_ki")
stationaryN <- matrix(NA, nrow = 6, ncol = length(projects), dimnames = list(
  c("2.5%", "25%", "50%", "75%", "97.5%", "mad"),
  projects))
nonStatN <- stationaryN
nModelBF <- numeric(length(projects))
nsModelBF <- nModelBF
nModelErr <- nModelBF
nsModelErr <- nModelErr

for (model in nModels) {
  usesModel <- whichModel == model
  modProjects <- projects[usesModel]
  nsModel <- sub("by_", "ns_", model, fixed = TRUE)
  cfModel <- c("by_n_ki" = "by_ki", "by_nt_ki" = "by_t_ki")[model]
  
  # Estimated value of n using the best available stationary model
  stationaryN[, usesModel] <- sapply(modProjects, function(pID) {
    res <- ExistingResults(pID, model, checkRemote = FALSE)[["parameters"]][, "rate_loss"]
    if (is.null(res)) {
      message("Need results for ", pID, "_", model)
      UpdateRecords(pID, model)
      res <- ExistingResults(pID, model, checkRemote = TRUE)[["parameters"]]
      if (!HasConverged(pID, model)) {
        MakeSlurm(pID, model, ml = FALSE)
      }
    }
    
    res %||% nullParam
  })
  nModelBF[usesModel] <- marginals[model, modProjects] -
    marginals[cfModel, modProjects]
  nModelErr[usesModel] <- .DiffErr(stdErr[model, modProjects],
                                   stdErr[cfModel, modProjects])
  
  # Estimated value of n using the best available non-stationary model
  nonStatN[,usesModel] <- sapply(modProjects, function(pID) {
    ExistingResults(pID, nsModel, checkRemote = FALSE)[["parameters"]][, "rate_loss"] %||% rep(NA, 6)
  })
  nsModelBF[usesModel] <- marginals[nsModel, modProjects] -
    marginals[cfModel, modProjects]
  nsModelErr[usesModel] <- stdErr[nsModel, modProjects] +
    stdErr[cfModel, modProjects]
}

mean(log(1 / stationaryN["50%", ]), na.rm = TRUE)
sd(log(1 / stationaryN["50%", ]), na.rm = TRUE)
median(log(1 / stationaryN["50%", ]), na.rm = TRUE)
mad(log(1 / stationaryN["50%", ]), na.rm = TRUE)


# Estimate the equivalent of n using the neomorphic-heterogeneous model
hgN <- sapply(projects, function(pID) {
  res <- ExistingResults(pID, "hg_ki", checkRemote = FALSE)[["parameters"]][, "mean_n"]
  if (is.null(res)) {
    message("Need results for ", pID, "_", model)
    RevBayes(pID, model)
    MakeSlurm(pID, model, ml = FALSE)
  }
  res %||% nullParam
})
length(which(hgN["2.5%", ] > 1))
length(which(hgN["97.5%", ] < 1))
sum(!is.na(hgN["97.5%", ]))

h50 <- log(hgN["50%", ])
vioplot::vioplot(h50)
shapiro.test(h50)

message(
  sprintf("value of log(_n_) is %.3f (%.3f) and %.3f (%.3f)",
          mean(h50, na.rm = TRUE), sd(h50, na.rm = TRUE),
          median(h50, na.rm = TRUE), mad(h50, na.rm = TRUE))
)


hgModelBF <- marginals["hg_ki", projects] - marginals["by_ki", projects]
hgModelErr <- stdErr["hg_ki", projects] + stdErr["by_ki", projects]
hg2N <- 1 / sapply(projects, function(pID) {
  tryCatch(
  ExistingResults(pID, "hg2_ki", checkRemote = FALSE
                  )[["parameters"]][, "mean_n"] %||% nullParam,
  error = function(e) {
    MakeSlurm(pID, "hg2_ki", ml = FALSE)
    return(nullParam)
  })
})
hg2ModelBF <- marginals["hg2_ki", projects] - marginals["by_ki", projects]
hg2ModelErr <- stdErr["hg2_ki", projects] + stdErr["by_ki", projects]

xLim <- c(1 / 140, 140)

{
par(mfrow = c(3, 2))
plot(stationaryN["50%", ], nModelBF,
     type = "n", # just whilst texting
     xlab = "Inferred 'n': best stationary model", ylab = "Model BF", xpd = NA,
     frame.plot = FALSE, pch = 4, log = "x", xlim = xLim)
confidenceCol <- gray.colors(256)
iqr <- log(stationaryN["75%", ]) - log(stationaryN["25%", ])
segments(stationaryN["2.5%", ], nModelBF, stationaryN["97.5%", ], xpd = NA,
         col = confidenceCol[cut(iqr, breaks = 256)])
text(stationaryN["50%", ], nModelBF, colnames(stationaryN), cex = 0.7, font = 2)
abline(v = 1, lty = 2)
abline(h = c(-1, 1) * log(10), lty = 2)

plot(nonStatN["50%", ], nsModelBF,
     type = "n", # just whilst texting
     xlab = "Inferred 'n': best non-stationary model", ylab = "Model BF", xpd = NA,
     frame.plot = FALSE, pch = 4, log = "x", xlim = xLim)
iqr <- log(nonStatN["75%", ]) - log(nonStatN["25%", ])
segments(nonStatN["2.5%", ], nsModelBF, nonStatN["97.5%", ], xpd = NA,
         col = confidenceCol[cut(iqr, breaks = 256)])
text(nonStatN["50%", ], nsModelBF, colnames(nonStatN), cex = 0.7, font = 2)
abline(v = 1, lty = 2)
abline(h = c(-1, 1) * log(10), lty = 2)

HetNPlot(hgN, hgModelBF, "hg_ki")
HetNPlot(hg2N, hg2ModelBF, "hg2_ki")

}

dev.new()
mod2plot <- .OutwithError(nModelBF, nModelErr, epsBF)
{
  pch <- c(17, 16, 15)
plot(stationaryN["50%", mod2plot], nonStatN["50%", mod2plot],
     frame.plot = FALSE, asp = 1,
     pch = pch[[1]], col = durham$purple, log = "xy",
#     xlim = c(0, 20), ylim = c(0, 20),
     xlab = "median value of _n_, stationary model",
     ylab = "median value of _n_, comparator model")
legend("topleft", c("ns_n", "hg", "hg2"), bty = "n", cex = 1.4,
       pch = pch,
       col = unlist(durham[c("purple", "gold", "red")]))
points(stationaryN["50%", mod2plot], hgN["50%", mod2plot],
       col = durham$gold, pch = pch[[2]], xpd = NA)
points(stationaryN["50%", mod2plot], hg2N["50%", mod2plot],
       col = durham$red, pch = pch[[3]], xpd = NA)
abline(a = 0, b = 1, lty = 2, col = durham$concrete)
abline(h = 1, lty = 2, col = durham$concrete)
abline(v = 1, lty = 2, col = durham$concrete)
}


# Non-stationary models: distribution at root
rfMk <- sapply(KiProjects(), function(pID) {
  ExistingResults(pID, "ns_ki", checkRemote = FALSE
                  )[["parameters"]][, "root_freqs.1."] %||% nullParam
})
which(rfMk["50%", ] - rfMk["mad", ] - rfMk["mad", ] > 0.5)
length(which(rfMk["2.5%", ] > 0.5))
which(rfMk["50%", ] + rfMk["mad", ] + rfMk["mad", ] < 0.5)
length(which(rfMk["97.5%", ] < 0.5))
sum(!is.na(rfMk["50%", ]))

plot(rep(marginals["ns_ki", ] - marginals["by_ki", ], each = 2),
     rfMk[c("2.5%", "97.5%"), ],
     frame.plot = FALSE, pch = 3, col = durham$purple,
     xlim = c(-20, 80), xlab = "Bayes Factor in favour of Non-Stationary model",
     ylab = "Frequency of Absent state at root",
     type = "n"
     )
.ErrCompare <- function(mod1, mod2, eps = epsBF) {
  .OutwithError(marginals[mod1, ] - marginals[mod2, ],
                .DiffErr(stdErr[mod1, ], stdErr[mod2, ]), eps)
}
nsDiffers <- .ErrCompare("ns_ki", "by_ki", epsBF) | 
  .ErrCompare("by_ki", "ns_ki", epsBF)
segments(marginals["ns_ki", ] - marginals["by_ki", ],
         y0 = rfMk["2.5%", ], y1 = rfMk["97.5%", ],
         col = ifelse(nsDiffers, durham$purple, durham$heather))
points(marginals["ns_ki", ] - marginals["by_ki", ], rfMk["50%", ],
       col = ifelse(nsDiffers, durham$purple, durham$heather),
       pch = 4)
abline(h = 0.5, lty = "dotted")
EpsLine(v = TRUE)
  
rfN <- sapply(projects, function(pID) {
  ExistingResults(pID, "ns_n_ki", checkRemote = FALSE
                  )[["parameters"]][, "root_freqs.1."] %||% nullParam
})
which(rfN["50%", ] - rfN["mad", ] - rfN["mad", ] > 0.5)
length(which(rfN["2.5%", ] > 0.5))
which(rfN["50%", ] + rfN["mad", ] + rfN["mad", ] < 0.5)
length(which(rfN["97.5%", ] < 0.5))
sum(!is.na(rfN["50%", ]))

plot(rep(marginals["ns_n_ki", ] - marginals["by_n_ki", ], each = 2),
     rfN[c("2.5%", "97.5%"), ],
     frame.plot = FALSE, pch = 3, col = durham$purple,
     xlim = c(-20, 80), xlab = "Bayes Factor in favour of Non-Stationary model",
     ylab = "Frequency of Absent state at root",
     type = "n"
)
nsnDiffers <- .ErrCompare("ns_n_ki", "by_n_ki", eps) |
  .ErrCompare("by_n_ki", "ns_n_ki", eps)
segments(marginals["ns_n_ki", ] - marginals["by_n_ki", ],
         y0 = rfN["2.5%", ], y1 = rfN["97.5%", ],
         col = ifelse(nsnDiffers, durham$purple, durham$heather))
points(marginals["ns_n_ki", ] - marginals["by_n_ki", ], rfN["50%", ],
         col = ifelse(nsnDiffers, durham$purple, durham$heather),
       pch = 4)
abline(h = 0.5, lty = "dotted")
EpsLine(v = TRUE)
-->
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin R. Smith.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
